<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>ðŸŒ± ExperiÃªncia AR</title>

  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <script src="https://raw.githack.com/fcor/arjs-gestures/master/dist/gestures.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>

  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: 'Poppins', sans-serif;
      background: #f5e4b8;
    }

    #startScreen {
      position: fixed;
      inset: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      background: linear-gradient(180deg, #a8d5a2 0%, #f2e0a2 45%, #f6c86e 100%);
      padding: 6vh 5vw;
      box-sizing: border-box;
      overflow-y: auto;
      z-index: 1000;
    }

    #startScreen h1 {
      font-size: clamp(26px, 6vw, 36px);
      font-weight: 800;
      color: #3b3820;
      margin-bottom: 2vh;
      text-shadow: 2px 2px 0 #f5e19f, 0 0 10px rgba(0,0,0,0.2);
    }

    #startScreen p {
      font-size: clamp(14px, 4vw, 17px);
      color: #3b3820;
      line-height: 1.5em;
      max-width: 420px;
      margin: 1.2vh 0;
    }

    .marker-card {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: linear-gradient(20deg, #fff8e1 0%, #f1e0b0 100%);
      border-radius: 18px;
      padding: 18px;
      margin: 15px 0 23px 0;
      box-shadow: 0 6px 12px rgba(0,0,0,0.15), inset 0 2px 0 rgba(255,255,255,0.7);
      width: 85%;
      max-width: 320px;
    }

    .marker-title {
      font-weight: 600;
      font-size: clamp(14px, 4vw, 16px);
      color: #4c3b16;
      margin-bottom: 10px;
      letter-spacing: 0.3px;
    }

    .marker-frame {
      background: #fdf6e3;
      border: 3px solid #d4b673;
      border-radius: 12px;
      padding: 8px;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.1), 0 2px 6px rgba(0,0,0,0.15);
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .marker-img {
      width: 100%;
      max-width: 200px;
      aspect-ratio: 1 / 1;
      object-fit: contain;
      border-radius: 10px;
      background: #fff;
      display: block;
    }

    #startBtn {
      margin-top: 3vh;
      padding: 1em 2.8em;
      font-size: clamp(15px, 4vw, 18px);
      border: none;
      border-radius: 12px;
      background: linear-gradient(160deg, #f6d36b, #d5a55a);
      color: #3b2b1f;
      font-weight: 700;
      box-shadow: 0 6px 0 #b3833c, 0 4px 12px rgba(0,0,0,0.3);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    #startBtn:active {
      transform: translateY(3px);
      box-shadow: 0 3px 0 #b3833c;
    }

    .credit {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.5);
      color: white;
      padding: 6px 12px;
      border-radius: 10px;
      font-size: clamp(10px, 3vw, 14px);
      white-space: nowrap;
      z-index: 999;
      bottom: 10px;
    }

    .credit a { color: #f7d46b; text-decoration: none; }
    .credit a:hover { text-decoration: underline; }

    /* Olhinho lÃ­quido */
    #liquidEye {
      position: fixed;
      top: 15px;
      right: 15px;
      width: 60px;
      height: 60px;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 50%;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.3s ease;
      z-index: 900;
    }

    #liquidEye:hover {
      transform: scale(1.1);
      box-shadow: 0 0 25px rgba(255, 255, 255, 0.5);
    }

    #liquidEye svg {
      filter: drop-shadow(0 0 8px rgba(255,255,255,0.4));
    }
  </style>
</head>

<body>
  <div id="startScreen">
    <h1>ðŸŒ¿ ExperiÃªncia AR</h1>
    <p><b>Passo 1:</b> Imprima ou tire um print do marcador <b>Hiro</b> abaixoðŸ‘‡</p>

    <div class="marker-card">
      <p class="marker-title">ðŸª¶ Marcador Hiro</p>
      <div class="marker-frame">
        <img src="assets/hiro.png" alt="Marcador Hiro" class="marker-img">
      </div>
    </div>

    <p><b>Passo 2:</b> Toque em <b>ComeÃ§ar</b> e direcione a cÃ¢mera para o marcador.</p>
    <p><b>Passo 3:</b> Interaja com o modelo 3D:<br>
      ðŸ‘‰ Toque com um dedo para girar<br>
      ðŸ‘‰ Use dois dedos para ajustar o tamanho
    </p>

    <button id="startBtn">ComeÃ§ar</button>
  </div>

  <!-- Cena AR -->
  <a-scene embedded arjs="sourceType: webcam;" gesture-detector>
    <a-entity camera></a-entity>

    <a-marker preset="hiro">
      <a-entity id="model"
        gltf-model="url(assets/onion_shrub.glb)"
        scale="0.2 0.2 0.2"
        position="0 0 0"
        rotation="0 0 0"
        gesture-handler="minScale: 0.1; maxScale: 1;"
        animation-mixer="clip:*; loop: repeat; autoplay: false;">
      </a-entity>

      <a-light type="ambient" color="#ffffff" intensity="2"></a-light>
      <a-light type="directional" intensity="0.8" position="-1 4 5"></a-light>
    </a-marker>
  </a-scene>

  <!-- Olhinho lÃ­quido no canto superior direito -->
  <div id="liquidEye">
    <svg viewBox="0 0 64 64" width="50" height="50">
      <path d="M32 12C18 12 6 24 6 32s12 20 26 20 26-12 26-20S46 12 32 12z" 
            fill="rgba(255,255,255,0.2)" stroke="rgba(255,255,255,0.6)" stroke-width="2"/>
      <circle cx="32" cy="32" r="8" fill="rgba(255,255,255,0.8)">
        <animate attributeName="r" values="8;10;8" dur="3s" repeatCount="indefinite"/>
      </circle>
    </svg>
  </div>

  <div class="credit">
    Modelo 3D por <a href="https://sketchfab.com/3d-models/onion-shrub-0be82a8f365b45dcbd25c6e395b4ec5d" target="_blank">DogOnAKeyboard</a>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const model = document.querySelector('#model');
    const startBtn = document.getElementById('startBtn');
    const startScreen = document.getElementById('startScreen');
    const liquidEye = document.getElementById('liquidEye');
    let isPlaying = false;
    let rotation = { x: 0, y: 0, z: 0 };

    const initialPosition = model.getAttribute('position');
    const initialRotation = model.getAttribute('rotation');

    model.addEventListener('click', () => {
      model.setAttribute('animation-mixer', { timeScale: isPlaying ? 0 : 1 });
      isPlaying = !isPlaying;
    });

    model.addEventListener("onefingermove", (event) => {
      rotation.x += event.detail.positionChange.y * 0.2;
      rotation.y += event.detail.positionChange.x * 0.2;
      model.setAttribute("rotation", `${rotation.x} ${rotation.y} ${rotation.z}`);
    });

    document.addEventListener('dblclick', () => {
      model.removeAttribute('animation__pos');
      model.removeAttribute('animation__rot');
      model.removeAttribute('animation__glow');

      model.setAttribute('animation__pos', {
        property: 'position',
        to: `${initialPosition.x} ${initialPosition.y} ${initialPosition.z}`,
        dur: 1000,
        easing: 'easeInOutQuad'
      });

      model.setAttribute('animation__rot', {
        property: 'rotation',
        to: `${initialRotation.x} ${initialRotation.y} ${initialRotation.z}`,
        dur: 1000,
        easing: 'easeInOutQuad'
      });

      rotation = { ...initialRotation };

      model.setAttribute('animation__glow', {
        property: 'scale',
        from: '0.2 0.2 0.2',
        to: '0.23 0.23 0.23',
        dur: 400,
        dir: 'alternate',
        easing: 'easeInOutSine',
        loop: 2
      });
    });

    startBtn.addEventListener('click', () => {
      startScreen.style.display = "none";
    });

    // Novo: clicar no olhinho abre nova cena AR
    liquidEye.addEventListener('click', () => {
      window.location.href = "estagiooculto.html"; 
    });
  });
  </script>
</body>
</html>
